@using MudBlazor
@inject HttpClient Http
@inject ISnackbar Snackbar

<MudPaper>
    <MudForm @ref="_form" Model="_libro">
        
        <MudButton OnClick="SubmitForm">Guardar</MudButton>
    </MudForm>
</MudPaper>

@code {
    
    private MudForm _form;
    private LibroDto _libro = new();

    private async Task SubmitForm()
    {
        await _form.Validate();

        if (_form.IsValid)
        {
            var response = await Http.PostAsJsonAsync("api/libros", _libro);

            if (response.IsSuccessStatusCode)
            {
                Snackbar.Add("Libro registrado exitosamente", Severity.Success);
                _libro = new();
            }
            else
            {
                var error = await response.Content.ReadAsStringAsync();
                Snackbar.Add($"Error al registrar libro: {error}", Severity.Error);
            }
        }
    }

    
    public class LibroDto
    {
        public string Titulo { get; set; } = "";
        public string Anio { get; set; } = "";
        public string Genero { get; set; } = "";
        public int? NumPaginas { get; set; }
        public string Autor { get; set; } = "";
    }
}
